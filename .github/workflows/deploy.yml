# åŸºäº gh-pages åŒ…çš„éƒ¨ç½²å·¥ä½œæµ
name: Deploy React App to GitHub Pages using gh-pages

# è§¦å‘æ¡ä»¶
on:
  push:
    branches: [ main ]
  workflow_dispatch:

# æƒé™è®¾ç½®
permissions:
  contents: write  # å…è®¸å†™å…¥ gh-pages åˆ†æ”¯
  pages: write     # å…è®¸å†™å…¥ GitHub Pages
  id-token: write # å…è®¸å†™å…¥ ID ä»¤ç‰Œ

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout ğŸ›ï¸
      uses: actions/checkout@v4
      with:
        fetch-depth: 0  # è·å–å®Œæ•´å†å²è®°å½•
        token: ${{ secrets.GITHUB_TOKEN }}  # ä½¿ç”¨ GitHub Token
      
    - name: Setup Node.js âš™ï¸
      uses: actions/setup-node@v4
      with:
        node-version: '18'
        cache: 'npm'
        
    - name: Install dependencies ğŸ”§
      run: npm ci
      
    - name: Configure Git ğŸ“
      run: |
        git config --global user.name "GitHub Actions Bot"
        git config --global user.email "actions@github.com"
        
    - name: Build React App ğŸ—ï¸
      run: npm run build
      env:
        CI: false  # é¿å…è­¦å‘Šä¸­æ–­æ„å»º
        PUBLIC_URL: https://stardust0083-gp03.github.io
        
    - name: Deploy using gh-pages package ğŸš€
      run: npm run deploy
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        
    - name: Verify Deployment âœ…
      run: |
        echo "ğŸ‰ Deployment successful!"
        echo "ğŸ“¦ Used gh-pages package for deployment"
        echo "ğŸŒ Your blog is available at: https://stardust0083-gp03.github.io/"
        echo "ğŸ“ Build files deployed to gh-pages branch"